import{a as f,i as ae,d as o,e,f as c,w as b,t as n,F as _,j as p,m as M,l as y,g as le,r as k,o as a,u as x,n as ne,k as z}from"./index-ystOkTZM.js";import{_ as G}from"./tick-UXBKKqVC.js";import{M as R,d as C}from"./bootstrap.esm-Rs7Aj1ey.js";import{S as q}from"./sweetalert2.all-6XfT6ZgS.js";const ce={class:"container"},ie={class:"list-unstyled d-flex page-box mb-4"},de={class:"page-item"},re={class:"page-item"},_e={class:"bg-white-box mb-2"},ue={class:"d-flex gap-2"},he={class:""},me=e("label",{for:"searchInput",class:"form-label"},"頁面名稱",-1),be={class:""},pe=e("label",{for:"search-creator",class:"form-label"},"建立者",-1),ge=e("option",{value:"",disabled:""},"請選擇建立者",-1),fe=["value"],ve=e("button",{type:"submit",class:"btn btn-gray fw-semibold"},"搜尋",-1),we={class:"d-flex justify-content-between align-items-end mb-2"},ye=e("h4",{class:"fw-semibold"},"列表",-1),ke={class:"d-flex gap-2 align-items-center me-2"},xe={class:"mb-0 me-2"},Ce={class:"bg-white-box h-100"},Pe={class:"table-responsive"},Ue={class:"table table-hover"},Me=e("thead",{class:"table-head"},[e("tr",null,[e("th",{scope:"col"},"排序"),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"頁面名稱")]),e("th",{class:"table-img-col",scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"建立者")]),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"共用者")]),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"操作")])])],-1),Fe={key:0},Ne={scope:"row",class:"text-center"},Ee={class:"ps-2 d-flex align-items-center"},Ve=["src"],je={class:"mb-0"},Be={class:"ps-2"},Se=["src"],Ae={class:"ps-2 d-flex align-items-center table-img-box"},Ie=["src"],$e={class:"ps-2"},De=["onClick"],Le=["onClick"],Te={key:0},ze=e("p",{style:{"text-align":"center","padding-bottom":"32vh"}},"尚無資料",-1),Re=[ze],qe={class:"modal fade",id:"pageEditModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"pageEditModalLabel","aria-hidden":"true"},Ge={class:"modal-dialog modal-dialog-centered"},He={class:"modal-content bg-white-box p-2"},Je={class:"modal-header border-0"},Ke={class:"title-word"},Oe=e("span",{class:"colr-block"},null,-1),Qe={class:"mb-0 fw-semibold"},We=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Xe={class:"modal-body"},Ye={class:"bg-white-box bg-light p-3 mb-4"},Ze=e("p",{class:"fs-5"},"新增使用者：",-1),es={class:"d-flex gap-1"},ss={class:""},ts={class:""},os=e("option",{value:"",disabled:""},"單位",-1),as=["value"],ls={class:""},ns=e("option",{value:"",disabled:""},"職稱",-1),cs=["value"],is=e("div",{class:""},[e("button",{type:"submit",class:"btn btn-outline-gray text-nowrap border-0"}," 篩選 ")],-1),ds={class:"mb-3"},rs=e("p",{class:"fw-light"},"建立者：",-1),_s={class:"d-flex"},us=["src","alt"],hs={class:"d-flex flex-column justify-content-between"},ms={class:"fs-5 fw-light mb-0"},bs={class:"fs-5 mb-0"},ps={class:"mb-3"},gs={class:"d-flex justify-content-between"},fs=e("p",{class:"fw-light"},"具有權限的使用者：",-1),vs={class:"fs-5 fw-light"},ws={key:0,class:"separator"},ys={class:"d-flex justify-content-between"},ks={class:"d-flex"},xs=["src"],Cs={class:"d-flex flex-column justify-content-between"},Ps={class:"fs-5 fw-light mb-0"},Us={class:"fs-5 mb-0"},Ms={class:"col-3"},Fs={type:"button",class:"btn btn-outline-gray dropdown-toggle text-black","data-bs-toggle":"dropdown","aria-expanded":"false"},Ns={class:"dropdown-menu access-box"},Es=["onClick"],Vs={class:"d-flex"},js=e("img",{src:G,alt:"tick"},null,-1),Bs={class:"text-center"},Ss={class:"modal fade",id:"delPageModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"delPageModalLabel","aria-hidden":"true"},As={class:"modal-dialog modal-dialog-centered"},Is={class:"modal-content bg-white-box"},$s=le('<div class="modal-header border-0"><div class="title-word"><span class="colr-block"></span><h2 class="mb-0 fw-semibold">刪除頁面</h2></div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>',1),Ds={class:"modal-body"},Ls={class:"fw-semibold"},Ts={class:"d-flex gap-2 justify-content-center"},zs=e("button",{type:"submit",class:"fw-semibold btn btn-outline-black w-50","data-bs-dismiss":"modal"}," 取消 ",-1),Os={__name:"PageMangerView",setup(Rs){const m=f(null),P=f(null),U=f(null),v=f(null),i=f(null),{userDatas:F}=C,H=C.pageAccesss,J=C.titles,K=C.departments,N=f(null);function O(t){console.log(t)}function Q(){N.value.resetForm()}const W=t=>{U.value.show(),v.value={...t}};function X(t){m.value=m.value.filter((l,d)=>l.id!==t),v.value=null,U.value.hide(),q.fire({icon:"success",title:"已刪除",showConfirmButton:!1,timer:2e3})}const Y=t=>{P.value.show(),i.value={...t}},Z=()=>{P.value.hide()};(()=>{const t=[];F.forEach(l=>{l.pageAccess.forEach(d=>{const r=t.find(u=>u.pageName===d.page);if(r)r.shareUser.push({...l});else{const u={id:t.length+1,pageName:d.page,createUser:{...l},shareUser:[{...l}]};t.push(u)}})}),m.value=t})();const ee=t=>{switch(t){case"首頁":return"/src/assets/image/icons/home.png";case"用電分析":return"/src/assets/image/icons/power.png";case"目標管理":return"/src/assets/image/icons/target.png";case"能源管理":return"/src/assets/image/icons/energy.png";case"人流監控":return"/src/assets/image/icons/people.png";default:return"/src/assets/image/icons/home.png"}};ae(()=>{P.value=new R("#pageEditModal",{keyboard:!1}),U.value=new R("#delPageModal",{keyboard:!1})});function E(t){switch(t){case"editable":return"編輯者";case"onlyView":return"檢視者";case"del":return"移除權限";default:return t}}function V(t,l){const d=t.pageName;return l.pageAccess.filter(w=>w.page===d)[0].access}function se(t){q.fire({icon:"success",title:"已移除",position:"top",showConfirmButton:!1,timer:2e3})}function te(t,l,d){console.log()}function oe(t){console.log(t)}return(t,l)=>{var j,B,S,A,I,$,D,L;const d=k("router-link"),r=k("VField"),u=k("ErrorMessage"),w=k("VForm");return a(),o(_,null,[e("div",ce,[e("ul",ie,[e("li",de,[c(d,{to:"/access/accountManger",class:"page-link fs-4"},{default:b(()=>[y("帳號")]),_:1})]),e("li",re,[c(d,{to:"/access/pageManger",class:"page-link fs-4"},{default:b(()=>[y("頁面")]),_:1})])]),e("section",_e,[c(w,{class:"d-flex justify-content-between align-items-end",ref_key:"searchForm",ref:N,onSubmit:O},{default:b(()=>[e("div",ue,[e("div",he,[me,c(r,{class:"form-control",name:"searchInput",type:"text",id:"searchInput",placeholder:"請輸入頁面名稱"})]),e("div",be,[pe,c(r,{id:"search-creator",name:"creator",as:"select",class:"form-select"},{default:b(()=>[ge,(a(!0),o(_,null,p(x(F),s=>(a(),o("option",{key:s.id,value:s.name},n(s.name),9,fe))),128))]),_:1}),c(u,{as:"p",class:"invalid-feedback d-block mb-0",name:"creator"})])]),e("div",{class:"d-flex gap-2"},[e("button",{type:"button",class:"btn btn-outline-gray fw-semibold",onClick:Q}," 清除 "),ve])]),_:1},512)]),e("section",null,[e("div",we,[ye,e("div",ke,[e("p",xe,"共計："+n(m.value.length)+" 筆",1)])]),e("div",Ce,[e("div",Pe,[e("table",Ue,[Me,m.value.length>0?(a(),o("tbody",Fe,[(a(!0),o(_,null,p(m.value,(s,g)=>(a(),o("tr",{key:s.id},[e("th",Ne,n(g+1),1),e("td",null,[e("div",Ee,[e("img",{class:"table-img-icon me-1",src:ee(s.pageName),alt:""},null,8,Ve),e("p",je,n(s.pageName),1)])]),e("td",null,[e("div",Be,[e("img",{class:"table-img-head",src:s.createUser.photo,alt:""},null,8,Se)])]),e("td",null,[e("div",Ae,[(a(!0),o(_,null,p(s.shareUser,(h,T)=>(a(),o("img",{key:T,class:"table-img-head",src:h.photo,alt:""},null,8,Ie))),128))])]),e("td",null,[e("div",$e,[e("button",{class:"btn btn-outline-primary border-0 fw-semibold",type:"button",onClick:h=>Y(s)}," 編輯 ",8,De),e("button",{type:"button",class:"btn btn-outline-danger border-0 fw-semibold",onClick:h=>W(s)}," 刪除 ",8,Le)])])]))),128))])):M("",!0)]),m.value.length<=0?(a(),o("span",Te,Re)):M("",!0)])])])]),e("div",qe,[e("div",Ge,[e("div",He,[e("div",Je,[e("div",Ke,[Oe,e("h2",Qe,"編輯「"+n((j=i.value)==null?void 0:j.pageName)+"」頁面權限",1)]),We]),e("div",Xe,[e("div",Ye,[Ze,c(w,{ref:"searchUserForm",onSubmit:oe},{default:b(()=>[e("div",es,[e("div",ss,[c(r,{class:"form-control",name:"searchInput",type:"text",id:"userInput",placeholder:"請輸入使用者名稱、帳號或Email"})]),e("div",ts,[c(r,{id:"search-department",name:"department",as:"select",class:"form-select"},{default:b(()=>[os,(a(!0),o(_,null,p(x(K),s=>(a(),o("option",{key:s,value:s},n(s),9,as))),128))]),_:1}),c(u,{as:"p",class:"invalid-feedback d-block mb-0",name:"department"})]),e("div",ls,[c(r,{id:"search-title",name:"title",as:"select",class:"form-select"},{default:b(()=>[ns,(a(!0),o(_,null,p(x(J),s=>(a(),o("option",{key:s,value:s},n(s),9,cs))),128))]),_:1}),c(u,{as:"p",class:"invalid-feedback d-block mb-0",name:"title"})]),is])]),_:1},512)]),e("div",ds,[rs,e("div",_s,[e("img",{class:"table-img-head me-2",src:(B=i.value)==null?void 0:B.createUser.photo,alt:(S=i.value)==null?void 0:S.createUser.name},null,8,us),e("div",hs,[e("p",ms,n((A=i.value)==null?void 0:A.createUser.name),1),e("p",bs,n((I=i.value)==null?void 0:I.createUser.phone),1)])])]),e("div",ps,[e("div",gs,[fs,e("p",vs,"共計："+n(($=i.value)==null?void 0:$.shareUser.length)+" 位",1)]),(a(!0),o(_,null,p((D=i.value)==null?void 0:D.shareUser,(s,g)=>(a(),o(_,{key:s.id},[g!=0?(a(),o("div",ws)):M("",!0),e("div",ys,[e("div",ks,[e("img",{class:"table-img-head me-2",src:s.photo,alt:""},null,8,xs),e("div",Cs,[e("p",Ps,n(s.name),1),e("p",Us,n(s.phone),1)])]),e("div",Ms,[e("button",Fs,n(E(V(i.value,s))),1),e("ul",Ns,[(a(!0),o(_,null,p(x(H),h=>(a(),o("li",{key:h,class:"d-flex"},[e("img",{src:G,class:ne([h===V(i.value,s)?"visible":""]),alt:"tick"},null,2),e("a",{class:"dropdown-item",href:"#",onClick:z(T=>te(i.value),["prevent"])},n(E(h)),9,Es)]))),128)),e("li",Vs,[js,e("a",{class:"dropdown-item text-danger border-0",href:"#",onClick:l[0]||(l[0]=z(h=>se(t.access),["prevent"]))},"移除權限")])])])])],64))),128))]),e("div",Bs,[e("button",{type:"button",class:"btn btn-primary w-50",onClick:l[1]||(l[1]=s=>Z())}," 完成 ")])])])])]),e("div",Ss,[e("div",As,[e("div",Is,[$s,e("div",Ds,[e("p",null,[y(" 確定要刪除 "),e("span",Ls,n((L=v.value)==null?void 0:L.pageName),1),y(" 與頁面內容嗎？ ")]),e("div",Ts,[e("button",{type:"submit",class:"fw-semibold btn btn-danger w-50",onClick:l[2]||(l[2]=s=>{var g;return X((g=v.value)==null?void 0:g.id)})}," 確定刪除 "),zs])])])])])],64)}}};export{Os as default};
