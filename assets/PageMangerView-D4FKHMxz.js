import{a as g,j as oe,d as o,e,f as d,w as f,t as n,F as r,k as m,p as P,m as L,g as ae,r as U,o as a,u as y,n as le,l as T}from"./index-K0WYNi0E.js";import{_ as R}from"./tick-UXBKKqVC.js";import{M as z,_ as ne,a as ce,d as x}from"./ItemNav-KjmjetCZ.js";const ie={class:"container"},de={class:"bg-white-box mb-2"},re={class:"d-flex gap-2"},_e={class:""},ue=e("label",{for:"searchInput",class:"form-label"},"頁面名稱",-1),be={class:""},he=e("label",{for:"search-creator",class:"form-label"},"建立者",-1),me=e("option",{value:"",disabled:""},"請選擇建立者",-1),pe=["value"],ge=e("button",{type:"submit",class:"btn btn-gray fw-semibold"},"搜尋",-1),fe={class:"d-flex justify-content-between align-items-end mb-2"},ve=e("h4",{class:"fw-semibold"},"列表",-1),we={class:"d-flex gap-2 align-items-center me-2"},ye={class:"mb-0 me-2"},xe={class:"bg-white-box h-100"},ke={class:"table-responsive"},Ce={class:"table table-hover"},Pe=e("thead",{class:"table-head"},[e("tr",null,[e("th",{scope:"col"},"排序"),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"頁面名稱")]),e("th",{class:"table-img-col",scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"建立者")]),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"共用者")]),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"操作")])])],-1),Ue={key:0},Fe={scope:"row",class:"text-center"},Me={class:"ps-2 d-flex align-items-center"},Ne=["src"],Ee={class:"mb-0"},Ve={class:"ps-2"},je=["src"],Ae={class:"ps-2 d-flex align-items-center table-img-box"},Se=["src"],$e={class:"ps-2"},Be=["onClick"],Ie=["onClick"],qe={key:0},De=e("p",{style:{"text-align":"center","padding-bottom":"32vh"}},"尚無資料",-1),Le=[De],Te={class:"modal fade",id:"pageEditModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"pageEditModalLabel","aria-hidden":"true"},ze={class:"modal-dialog modal-dialog-centered"},Re={class:"modal-content bg-white-box p-2"},Ge={class:"modal-header border-0"},He={class:"title-word"},Je=e("span",{class:"colr-block"},null,-1),Ke={class:"mb-0 fw-semibold"},Oe=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Qe={class:"modal-body"},We={class:"bg-white-box bg-light p-3 mb-4"},Xe=e("p",{class:"fs-5"},"新增使用者：",-1),Ye={class:"d-flex gap-1"},Ze={class:""},es={class:""},ss=e("option",{value:"",disabled:""},"單位",-1),ts=["value"],os={class:""},as=e("option",{value:"",disabled:""},"職稱",-1),ls=["value"],ns=e("div",{class:""},[e("button",{type:"submit",class:"btn btn-outline-gray text-nowrap border-0"}," 篩選 ")],-1),cs={class:"mb-3"},is=e("p",{class:"fw-light"},"建立者：",-1),ds={class:"d-flex"},rs=["src","alt"],_s={class:"d-flex flex-column justify-content-between"},us={class:"fs-5 fw-light mb-0"},bs={class:"fs-5 mb-0"},hs={class:"mb-3"},ms={class:"d-flex justify-content-between"},ps=e("p",{class:"fw-light"},"具有權限的使用者：",-1),gs={class:"fs-5 fw-light"},fs={key:0,class:"separator"},vs={class:"d-flex justify-content-between"},ws={class:"d-flex"},ys=["src"],xs={class:"d-flex flex-column justify-content-between"},ks={class:"fs-5 fw-light mb-0"},Cs={class:"fs-5 mb-0"},Ps={class:"col-3"},Us={type:"button",class:"btn btn-outline-gray dropdown-toggle text-black","data-bs-toggle":"dropdown","aria-expanded":"false"},Fs={class:"dropdown-menu access-box"},Ms=["onClick"],Ns={class:"d-flex"},Es=e("img",{src:R,alt:"tick"},null,-1),Vs={class:"text-center"},js={class:"modal fade",id:"delPageModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"delPageModalLabel","aria-hidden":"true"},As={class:"modal-dialog modal-dialog-centered"},Ss={class:"modal-content bg-white-box"},$s=ae('<div class="modal-header border-0"><div class="title-word"><span class="colr-block"></span><h2 class="mb-0 fw-semibold">刪除頁面</h2></div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>',1),Bs={class:"modal-body"},Is={class:"fw-semibold"},qs={class:"d-flex gap-2 justify-content-center"},Ds=e("button",{type:"submit",class:"fw-semibold btn btn-outline-black w-50","data-bs-dismiss":"modal"}," 取消 ",-1),Hs={__name:"PageMangerView",setup(Ls){const{swalSuccess:F}=ce,u=g(null),k=g(null),C=g(null),v=g(null),i=g(null),{userDatas:M}=x,G=x.pageAccesss,H=x.titles,J=x.departments,N=g(null);function K(t){console.log(t)}function O(){N.value.resetForm()}const Q=t=>{C.value.show(),v.value={...t}};function W(t){u.value=u.value.filter((l,c)=>l.id!==t),v.value=null,C.value.hide(),F("已刪除")}const X=t=>{k.value.show(),i.value={...t}},Y=()=>{k.value.hide()};(()=>{const t=[];M.forEach(l=>{l.pageAccess.forEach(c=>{const b=t.find(h=>h.pageName===c.page);if(b)b.shareUser.push({...l});else{const h={id:t.length+1,pageName:c.page,createUser:{...l},shareUser:[{...l}]};t.push(h)}})}),u.value=t})();const Z=t=>{switch(t){case"首頁":return"/src/assets/image/icons/home.png";case"用電分析":return"/src/assets/image/icons/power.png";case"目標管理":return"/src/assets/image/icons/target.png";case"能源管理":return"/src/assets/image/icons/energy.png";case"人流監控":return"/src/assets/image/icons/people.png";default:return"/src/assets/image/icons/home.png"}};oe(()=>{k.value=new z("#pageEditModal",{keyboard:!1}),C.value=new z("#delPageModal",{keyboard:!1})});function E(t){switch(t){case"editable":return"編輯者";case"onlyView":return"檢視者";case"del":return"移除權限";default:return t}}function V(t,l){const c=t.pageName;return l.pageAccess.filter(w=>w.page===c)[0].access}function ee(t){F("已移除")}function se(t,l,c){console.log()}function te(t){console.log(t)}return(t,l)=>{var w,j,A,S,$,B,I,q;const c=U("VField"),b=U("ErrorMessage"),h=U("VForm");return a(),o(r,null,[e("div",ie,[d(ne,{"nav-where":"access"}),e("section",de,[d(h,{class:"d-flex justify-content-between align-items-end",ref_key:"searchForm",ref:N,onSubmit:K},{default:f(()=>[e("div",re,[e("div",_e,[ue,d(c,{class:"form-control",name:"searchInput",type:"text",id:"searchInput",placeholder:"請輸入頁面名稱"})]),e("div",be,[he,d(c,{id:"search-creator",name:"creator",as:"select",class:"form-select",required:""},{default:f(()=>[me,(a(!0),o(r,null,m(y(M),s=>(a(),o("option",{key:s.id,value:s.name},n(s.name),9,pe))),128))]),_:1}),d(b,{as:"p",class:"invalid-feedback d-block mb-0",name:"creator"})])]),e("div",{class:"d-flex gap-2"},[e("button",{type:"button",class:"btn btn-outline-gray fw-semibold",onClick:O}," 清除 "),ge])]),_:1},512)]),e("section",null,[e("div",fe,[ve,e("div",we,[e("p",ye,"共計："+n(u.value.length)+" 筆",1)])]),e("div",xe,[e("div",ke,[e("table",Ce,[Pe,u.value.length>0?(a(),o("tbody",Ue,[(a(!0),o(r,null,m(u.value,(s,p)=>(a(),o("tr",{key:s.id},[e("th",Fe,n(p+1),1),e("td",null,[e("div",Me,[e("img",{class:"table-img-icon me-1",src:Z(s.pageName),alt:""},null,8,Ne),e("p",Ee,n(s.pageName),1)])]),e("td",null,[e("div",Ve,[e("img",{class:"table-img-head",src:s.createUser.photo,alt:""},null,8,je)])]),e("td",null,[e("div",Ae,[(a(!0),o(r,null,m(s.shareUser,(_,D)=>(a(),o("img",{key:D,class:"table-img-head",src:_.photo,alt:""},null,8,Se))),128))])]),e("td",null,[e("div",$e,[e("button",{class:"btn btn-outline-primary border-0 fw-semibold",type:"button",onClick:_=>X(s)}," 編輯 ",8,Be),e("button",{type:"button",class:"btn btn-outline-danger border-0 fw-semibold",onClick:_=>Q(s)}," 刪除 ",8,Ie)])])]))),128))])):P("",!0)]),u.value.length<=0?(a(),o("span",qe,Le)):P("",!0)])])])]),e("div",Te,[e("div",ze,[e("div",Re,[e("div",Ge,[e("div",He,[Je,e("h2",Ke,"編輯「"+n((w=i.value)==null?void 0:w.pageName)+"」頁面權限",1)]),Oe]),e("div",Qe,[e("div",We,[Xe,d(h,{ref:"searchUserForm",onSubmit:te},{default:f(()=>[e("div",Ye,[e("div",Ze,[d(c,{class:"form-control",name:"searchInput",type:"text",id:"userInput",placeholder:"請輸入使用者名稱、帳號或Email"})]),e("div",es,[d(c,{id:"search-department",name:"department",as:"select",class:"form-select",required:""},{default:f(()=>[ss,(a(!0),o(r,null,m(y(J),s=>(a(),o("option",{key:s,value:s},n(s),9,ts))),128))]),_:1}),d(b,{as:"p",class:"invalid-feedback d-block mb-0",name:"department"})]),e("div",os,[d(c,{id:"search-title",name:"title",as:"select",class:"form-select",required:""},{default:f(()=>[as,(a(!0),o(r,null,m(y(H),s=>(a(),o("option",{key:s,value:s},n(s),9,ls))),128))]),_:1}),d(b,{as:"p",class:"invalid-feedback d-block mb-0",name:"title"})]),ns])]),_:1},512)]),e("div",cs,[is,e("div",ds,[e("img",{class:"table-img-head me-2",src:(j=i.value)==null?void 0:j.createUser.photo,alt:(A=i.value)==null?void 0:A.createUser.name},null,8,rs),e("div",_s,[e("p",us,n((S=i.value)==null?void 0:S.createUser.name),1),e("p",bs,n(($=i.value)==null?void 0:$.createUser.phone),1)])])]),e("div",hs,[e("div",ms,[ps,e("p",gs,"共計："+n((B=i.value)==null?void 0:B.shareUser.length)+" 位",1)]),(a(!0),o(r,null,m((I=i.value)==null?void 0:I.shareUser,(s,p)=>(a(),o(r,{key:s.id},[p!=0?(a(),o("div",fs)):P("",!0),e("div",vs,[e("div",ws,[e("img",{class:"table-img-head me-2",src:s.photo,alt:""},null,8,ys),e("div",xs,[e("p",ks,n(s.name),1),e("p",Cs,n(s.phone),1)])]),e("div",Ps,[e("button",Us,n(E(V(i.value,s))),1),e("ul",Fs,[(a(!0),o(r,null,m(y(G),_=>(a(),o("li",{key:_,class:"d-flex"},[e("img",{src:R,class:le([_===V(i.value,s)?"visible":""]),alt:"tick"},null,2),e("a",{class:"dropdown-item",href:"#",onClick:T(D=>se(i.value),["prevent"])},n(E(_)),9,Ms)]))),128)),e("li",Ns,[Es,e("a",{class:"dropdown-item text-danger border-0",href:"#",onClick:l[0]||(l[0]=T(_=>ee(t.access),["prevent"]))},"移除權限")])])])])],64))),128))]),e("div",Vs,[e("button",{type:"button",class:"btn btn-primary w-50",onClick:l[1]||(l[1]=s=>Y())}," 完成 ")])])])])]),e("div",js,[e("div",As,[e("div",Ss,[$s,e("div",Bs,[e("p",null,[L(" 確定要刪除 "),e("span",Is,n((q=v.value)==null?void 0:q.pageName),1),L(" 與頁面內容嗎？ ")]),e("div",qs,[e("button",{type:"submit",class:"fw-semibold btn btn-danger w-50",onClick:l[2]||(l[2]=s=>{var p;return W((p=v.value)==null?void 0:p.id)})}," 確定刪除 "),Ds])])])])])],64)}}};export{Hs as default};
