import{M as S,d as H}from"./bootstrap.esm-Rs7Aj1ey.js";import{S as J}from"./sweetalert2.all-6XfT6ZgS.js";import{a as m,i as K,d as l,e,f as h,w as f,t as o,F as p,j as U,m as C,l as u,g as M,r as v,o as c}from"./index-B-KMzsvO.js";const Q={class:"container"},W={class:"list-unstyled d-flex page-box mb-4"},X={class:"page-item"},Y={class:"page-item"},Z={class:"bg-white-box mb-2"},ee={class:"d-flex gap-2"},se={class:""},te=e("label",{for:"searchInput",class:"form-label"},"頁面名稱",-1),ae={class:""},oe=e("label",{for:"search-creator",class:"form-label"},"建立者",-1),le=e("option",{value:"",disabled:""},"請選擇建立者",-1),ce=e("button",{type:"submit",class:"btn btn-gray fw-semibold"},"搜尋",-1),ne={class:"d-flex justify-content-between align-items-end mb-2"},ie=e("h4",{class:"fw-semibold"},"列表",-1),de={class:"d-flex gap-2 align-items-center me-2"},re={class:"mb-0 me-2"},_e={class:"bg-white-box h-100"},be={class:"table-responsive"},me={class:"table table-hover"},he=e("thead",{class:"table-head"},[e("tr",null,[e("th",{scope:"col"},"排序"),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"頁面名稱")]),e("th",{class:"table-img-col",scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"建立者")]),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"共用者")]),e("th",{scope:"col"},[e("p",{class:"border-start border-2 ps-2 mb-0"},"操作")])])],-1),pe={key:0},ue={scope:"row",class:"text-center"},ge={class:"ps-2 d-flex align-items-center"},fe=["src"],ve={class:"mb-0"},we={class:"ps-2"},ye=["src"],xe={class:"ps-2 d-flex align-items-center table-img-box"},ke=["src"],Ue={class:"ps-2"},Ce=["onClick"],Me=["onClick"],Pe={key:0},Fe=e("p",{style:{"text-align":"center","padding-bottom":"32vh"}},"尚無資料",-1),Ne=[Fe],Ee={class:"modal fade",id:"pageEditModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"pageEditModalLabel","aria-hidden":"true"},Ve={class:"modal-dialog modal-dialog-centered"},je={class:"modal-content bg-white-box p-2"},Be=M('<div class="modal-header border-0"><div class="title-word"><span class="colr-block"></span><h2 class="mb-0 fw-semibold">編輯「用電管理」頁面權限</h2></div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>',1),De={class:"modal-body"},Se=M('<div class="bg-white-box bg-light p-3 mb-4"><p class="fs-5">新增使用者：</p><div class="d-flex gap-1"><div class=""><input type="text" class="form-control" id="userInput" placeholder="請輸入使用者名稱、帳號或Email"></div><div class=""><select class="form-select" aria-label="Default select example"><option selected>單位</option><option value="1">One</option></select></div><div class=""><select class="form-select" aria-label="Default select example"><option selected>職稱</option><option value="1">One</option></select></div><div class=""><p class="mb-0">篩選</p></div></div></div>',1),Ie={class:"mb-3"},$e=e("p",{class:"fw-light"},"建立者：",-1),Le={class:"d-flex"},Oe=["src","alt"],Te={class:"d-flex flex-column justify-content-between"},Ae={class:"fs-5 fw-light mb-0"},Re={class:"fs-5 mb-0"},qe={class:"mb-3"},ze={class:"d-flex justify-content-between"},Ge=e("p",{class:"fw-light"},"具有權限的使用者：",-1),He={class:"fs-5 fw-light"},Je={key:0,class:"separator"},Ke={class:"d-flex justify-content-between"},Qe={class:"d-flex"},We=["src"],Xe={class:"d-flex flex-column justify-content-between"},Ye={class:"fs-5 fw-light mb-0"},Ze={class:"fs-5 mb-0"},es={class:"text-center"},ss={class:"modal fade",id:"delPageModal","data-bs-backdrop":"static",tabindex:"-1","aria-labelledby":"delPageModalLabel","aria-hidden":"true"},ts={class:"modal-dialog modal-dialog-centered"},as={class:"modal-content bg-white-box"},os=M('<div class="modal-header border-0"><div class="title-word"><span class="colr-block"></span><h2 class="mb-0 fw-semibold">刪除頁面</h2></div><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>',1),ls={class:"modal-body"},cs={class:"fw-semibold"},ns={class:"d-flex gap-2 justify-content-center"},is=e("button",{type:"submit",class:"fw-semibold btn btn-outline-black w-50","data-bs-dismiss":"modal"}," 取消 ",-1),hs={__name:"PageMangerView",setup(ds){const d=m(null),w=m(null),y=m(null),g=m(null),n=m(null),{userDatas:I}=H,P=m(null);function $(s){console.log(s)}function L(){P.value.resetForm()}const O=s=>{y.value.show(),g.value={...s}};function T(s){d.value=d.value.filter((a,i)=>a.id!==s),g.value=null,y.value.hide(),J.fire({icon:"success",title:"已刪除",showConfirmButton:!1,timer:2e3})}const A=s=>{w.value.show(),n.value={...s}},R=()=>{w.value.hide()};(()=>{const s=[];I.forEach(a=>{a.pageAccess.forEach(i=>{const _=s.find(r=>r.pageName===i.page);if(_)_.shareUser.push({...a});else{const r={id:s.length+1,pageName:i.page,createUser:{...a},shareUser:[{...a}]};s.push(r)}})}),d.value=s})();const q=s=>{switch(s){case"首頁":return"/src/assets/image/icons/home.png";case"用電分析":return"/src/assets/image/icons/power.png";case"目標管理":return"/src/assets/image/icons/target.png";case"能源管理":return"/src/assets/image/icons/energy.png";case"人流監控":return"/src/assets/image/icons/people.png";default:return"/src/assets/image/icons/home.png"}};K(()=>{w.value=new S("#pageEditModal",{keyboard:!1}),y.value=new S("#delPageModal",{keyboard:!1})});function z(s,a){const i=s.pageName,r=a.pageAccess.filter(x=>x.page===i);console.log(r.access,a)}return(s,a)=>{var F,N,E,V,j,B,D;const i=v("router-link"),_=v("VField"),r=v("ErrorMessage"),x=v("VForm");return c(),l(p,null,[e("div",Q,[e("ul",W,[e("li",X,[h(i,{to:"/access/accountManger",class:"page-link fs-4"},{default:f(()=>[u("帳號")]),_:1})]),e("li",Y,[h(i,{to:"/access/pageManger",class:"page-link fs-4"},{default:f(()=>[u("頁面")]),_:1})])]),e("section",Z,[h(x,{class:"d-flex justify-content-between align-items-end",ref_key:"searchForm",ref:P,onSubmit:$},{default:f(()=>[e("div",ee,[e("div",se,[te,h(_,{class:"form-creator",name:"searchInput",type:"text",id:"searchInput",placeholder:"請輸入頁面名稱"})]),e("div",ae,[oe,h(_,{id:"search-creator",name:"creator",as:"select",class:"form-select"},{default:f(()=>[le]),_:1}),h(r,{as:"p",class:"invalid-feedback d-block mb-0",name:"creator"})])]),e("div",{class:"d-flex gap-2"},[e("button",{type:"button",class:"btn btn-outline-gray fw-semibold",onClick:L}," 清除 "),ce])]),_:1},512)]),e("section",null,[e("div",ne,[ie,e("div",de,[e("p",re,"共計："+o(d.value.length)+" 筆",1)])]),e("div",_e,[e("div",be,[e("table",me,[he,d.value.length>0?(c(),l("tbody",pe,[(c(!0),l(p,null,U(d.value,(t,b)=>(c(),l("tr",{key:t.id},[e("th",ue,o(b+1),1),e("td",null,[e("div",ge,[e("img",{class:"table-img-icon me-1",src:q(t.pageName),alt:""},null,8,fe),e("p",ve,o(t.pageName),1)])]),e("td",null,[e("div",we,[e("img",{class:"table-img-head",src:t.createUser.photo,alt:""},null,8,ye)])]),e("td",null,[e("div",xe,[(c(!0),l(p,null,U(t.shareUser,(k,G)=>(c(),l("img",{key:G,class:"table-img-head",src:k.photo,alt:""},null,8,ke))),128))])]),e("td",null,[e("div",Ue,[e("button",{class:"btn btn-outline-primary border-0 fw-semibold",type:"button",onClick:k=>A(t)}," 編輯 ",8,Ce),e("button",{type:"button",class:"btn btn-outline-danger border-0 fw-semibold",onClick:k=>O(t)}," 刪除 ",8,Me)])])]))),128))])):C("",!0)]),d.value.length<=0?(c(),l("span",Pe,Ne)):C("",!0)])])])]),e("div",Ee,[e("div",Ve,[e("div",je,[Be,e("div",De,[Se,e("div",Ie,[$e,e("div",Le,[e("img",{class:"table-img-head me-2",src:(F=n.value)==null?void 0:F.createUser.photo,alt:(N=n.value)==null?void 0:N.createUser.name},null,8,Oe),e("div",Te,[e("p",Ae,o((E=n.value)==null?void 0:E.createUser.name),1),e("p",Re,o((V=n.value)==null?void 0:V.createUser.phone),1)])])]),e("div",qe,[e("div",ze,[Ge,e("p",He,"共計："+o((j=n.value)==null?void 0:j.shareUser.length)+" 位",1)]),(c(!0),l(p,null,U((B=n.value)==null?void 0:B.shareUser,(t,b)=>(c(),l(p,{key:t.id},[b!=0?(c(),l("div",Je)):C("",!0),e("div",Ke,[e("div",Qe,[e("img",{class:"table-img-head me-2",src:t.photo,alt:""},null,8,We),e("div",Xe,[e("p",Ye,o(t.name),1),e("p",Ze,o(t.phone),1)])]),u(" "+o(t)+" "+o(n.value)+" "+o(z(n.value,t)),1)])],64))),128))]),e("div",es,[e("button",{type:"button",class:"btn btn-primary w-50",onClick:a[0]||(a[0]=t=>R())}," 完成 ")])])])])]),e("div",ss,[e("div",ts,[e("div",as,[os,e("div",ls,[e("p",null,[u(" 確定要刪除 "),e("span",cs,o((D=g.value)==null?void 0:D.pageName),1),u(" 與頁面內容嗎？ ")]),e("div",ns,[e("button",{type:"submit",class:"fw-semibold btn btn-danger w-50",onClick:a[1]||(a[1]=t=>{var b;return T((b=g.value)==null?void 0:b.id)})}," 確定刪除 "),is])])])])])],64)}}};export{hs as default};
